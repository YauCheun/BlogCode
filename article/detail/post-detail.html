<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>YauCheung的博客</title>
  <link rel="stylesheet" href="/static/assets/vendors/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="/static/assets/css/index.css">
  <link rel="stylesheet" href="/static/assets/css/base.css">
    <link rel="stylesheet" href="/static/assets/vendors/nprogress/nprogress.css">
  <script src="/static/assets/vendors/nprogress/nprogress.js"></script>
</head>
<body>
  <div class="header">
     <div class="container">
       <div class="row">
         <div class="col-md-4 col-xs-12">
          <a href="/index.html"><h2>YauCheung's Blog</h2>
          <p>Thoughts, stories and ideas.</p></a>
        </div>
         <div class="col-md-4 col-md-offset-4 hidden-xs hidden-sm"> 
          <div class="input-group">
            <input type="text" class="form-control" placeholder="输入关键字搜索">
            <span class="input-group-btn">
              <button class="btn btn-default" type="button">搜索</button>
            </span>
          </div><!-- /input-group -->
        </div>

      </div>
     </div>
  </div>
  <div class="main">
    <div class="container">
       <div class="row">
          <div class="col-sm-3 col-xs-12">
            <div class="category">
              <h3>&nbsp;&nbsp;个人分类</h3>
               <div class="list-group" id="category-list">
              <!--   <a class="list-group-item">
                  <span class="badge">14</span>
                  Cras justo odio
                </a>
                  <a class="list-group-item">
                  <span class="badge">14</span>
                  Cras justo odio
                </a>
                  <a class="list-group-item">
                  <span class="badge">14</span>
                  Cras justo odio
                </a> -->
              </div>
            </div>
            <div class="post">
              <h3>&nbsp;&nbsp;热门文章</h3>
                <div id="hot_posts">  
                </div>   
              <!-- <div class="list-group">
                <a href="#" class="list-group-item ">
                  <h4 class="list-group-item-heading">List group item heafsdfsfsdfsdfsdfsdding</h4>
                  <p class="list-group-item-text">阅读数: <span>22</span></p>
                </a>
              </div>
              <div class="list-group">
                <a href="#" class="list-group-item ">
                  <h4 class="list-group-item-heading">List group item heading</h4>
                  <p class="list-group-item-text">.sdfs..</p>
                </a>
              </div>
              <div class="list-group">
                <a href="#" class="list-group-item ">
                  <h4 class="list-group-item-heading">List group item heading</h4>
                  <p class="list-group-item-text">.sdfs..</p>
                </a>
              </div> -->
            </div>
            <div class="other hidden-xs">
              <h3>&nbsp;&nbsp;其他</h3>
              <div class="list-group">
                <a href="/admin/login.php" class="list-group-item ">
                博客管理
                </a>
                <a href="https://weibo.com/u/6018878594" class="list-group-item">我的微博</a>
                <a href="javascript:;" class="list-group-item">QQ邮箱：1272125039@qq.com</a>
                <a href="https://www.cnblogs.com/Yaucheun/" class="list-group-item">我的博客园</a>
              
              </div>
            </div>
          </div>
          <div class="col-sm-9 col-xs-12">
             <div class="post_detail" id="postdetail">
              <!--  <div class="post-detail-header">
                  <h2>文章标题</h2>
                  <p class="date">2019年3月21 19:22</p>
                  <p>浏览数：<span class="read">22</span></p>
               </div>
               <div class="post-detail-content">
             
               </div> -->
             </div>
             <div class="post-commets-list" >
               <h4>评论列表</h4>
               <div id="post_C"></div>
             <!--   <div class="comments">
                 <p class="date">2019年3月21日 20:25</p>
                 <p class="nickname">昵称</p><br>
                 <h5>评论内容士大夫撒旦发放时士大夫撒水电费</h5>
               </div>
                <div class="comments">
                 <p class="date">2019年3月21日 20:25</p>
                 <p class="nickname">昵称</p><br>
                 <h5>评论内容士大夫撒旦发放时士大夫撒水电费</h5>
               </div>
                <div class="comments">
                 <p class="date">2019年3月21日 20:25</p>
                 <p class="nickname">昵称</p><br>
                 <h5>评论内容士大夫撒旦发放时士大夫撒水电费</h5>
               </div> -->


             </div>
              <div class="post-comments">
                <form class="form-horizontal">
                  <div class="form-group">
                    <label for="nickname" class="col-sm-1 control-label">昵称</label>
                    <div class="col-sm-6">
                      <input type="text" class="form-control" id="nickname" placeholder="昵称">
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="content" class="col-sm-1 control-label">评论内容</label>
                    <div class="col-sm-6">
                      <textarea class="form-control" id="content" rows="3"></textarea>
                    </div>
                  </div>
                  <div class="form-group">
                    <div class="col-sm-offset-1 col-sm-10">
                      <a href="javascript:;" class="btn btn-default" id="submit">提交</a>
                    </div>
                  </div>
                </form>


              </div>          
          </div>
       </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="hidden-sm hidden-md hidden-lg col-xs-12">
            <div class="other">
              <h3>&nbsp;&nbsp;其他</h3>
              <div class="list-group">
                <a href="/admin/login.php" class="list-group-item ">
                博客管理
                </a>
                <a href="https://weibo.com/u/6018878594" class="list-group-item">我的微博</a>
                <a href="javascript:;" class="list-group-item">QQ邮箱：1272125039@qq.com</a>
                <a href="https://www.cnblogs.com/Yaucheun/" class="list-group-item">我的博客园</a>
              
              </div>
            </div>
        </div>
      </div>
    </div>
    <div class="foot">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <p style="text-align: center;">©2019 由 <span><a href="https://weibo.com/u/6018878594">YauCheung</a></span> 版权所有</p>
          </div>
        </div>
      </div>
    </div>
  </div>
   <script id="category_tmpl" type="text/x-jsrender">
    {{for commens}}
       <a class="list-group-item" href="/article/category/category.html?id={{: id}}">
                  <span class="badge">{{: count}}</span>
                {{: name}}
                </a>
    {{/for}}
  </script>
  <script id="hot_posts_tmpl" type="text/x-jsrender">
    {{for commens}}
        <div class="list-group">
                <a href="/article/detail/post-detail.html?id={{: id}}" class="list-group-item ">
                  <h4 class="list-group-item-heading">{{: title}}</h4>
                  <p class="list-group-item-text">阅读数：<span>{{: views}}</span></p>
                </a>
              </div>
    {{/for}}
  </script>
   <script id="posts_detail" type="text/x-jsrender">
     {{for commens}}
        <div class="post-detail-header">
                  <h2>{{: title}}</h2>
                  <p class="date">{{: created}}</p>
                  <p>浏览数：<span class="read">{{: views}}</span></p>
               </div>
               <div class="post-detail-content">
                {{: content}}
               </div> 
    {{/for}}
  </script>
   <script id="post_comments" type="text/x-jsrender">
     {{for commens}}
        </div>
                <div class="comments">
                 <p class="date">{{: created}}</p>
                 <p class="nickname">作者： {{: author}}</p><br>
                 <h5>{{: content}}</h5>
               </div>
    {{/for}}
  </script>
  <script src="/static/assets/vendors/jquery/jquery.js"></script>
    <script src="/static/assets/vendors/jsrender/jsrender.js"></script>
  <script src="/static/assets/vendors/bootstrap/js/bootstrap.js"></script>
  <script>
     var loc = location.href;
      var n1 = loc.length;//地址的总长度
      var n2 = loc.indexOf("=");//取得=号的位置
      var id = decodeURI(loc.substr(n2+1, n1-n2));//从=号后面的内容
    $(function($){
     $(document).ajaxStart(function() {
      NProgress.start();
    }).ajaxStop(function() {
      NProgress.done();
    });
    

      $.get('/admin/api/category.php', function(data) {
        var html=$('#category_tmpl').render({commens: data.category});
        $('#category-list').html(html);
          var html=$('#hot_posts_tmpl').render({commens: data.hot_post});
        $('#hot_posts').html(html);

        $.get('/admin/api/post-detail.php',{id:id},function(res) {
         var html=$('#posts_detail').render({commens: res.post_word});
         $('#postdetail').html(html);
         var html=$('#post_comments').render({commens: res.post_comments});
         $('#post_C').html(html);
      });
         
      });

      $('#submit').on('click',function(){
          var nickname=$('#nickname').val();
          var content=$('#content').val();
          var d = new Date();
          var vYear = d.getFullYear()
          var vMon = d.getMonth() + 1
          var vDay = d.getDate();
          var h = d.getHours(); 
          var m = d.getMinutes(); 
          var se = d.getSeconds(); 
          currenttime=vYear + "-" +(vMon<10 ? "0" + vMon : vMon) + "-" +(vDay<10 ? "0"+ vDay : vDay)+" "+(h<10 ? "0"+ h : h) + ":"+(m<10 ? "0" + m : m) + ":"+(se<10 ? "0" +se : se);
          if (!nickname) {
            alert('请完整填写内容');
          }else if (!content) {
             alert('请完整填写内容');
          }else {
               $.post('/admin/api/post-comment.php',{id:id,nickname:nickname,content:content,time:currenttime}, function(data) {
           if (data>0) {
             alert('评论成功,需管理员审核');
             $.get('/admin/api/post-detail.php',{id:id},function(res) {
               var html=$('#post_comments').render({commens: res.post_comments});
               $('#post_C').html(html);
      });
           }else {
              alert('评论失败');
           }
          });
          }
       


      });
     
     


    })


  </script>
</body>
</html>